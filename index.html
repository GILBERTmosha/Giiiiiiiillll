<!DOCTYPE html>
<html lang="sw">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MOSHARUTH WiFi</title>

<style>
body{
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#000,#222);
    color:#fff;
    margin:0;
}
.container{
    max-width:430px;
    margin:35px auto;
    background:#050505;
    padding:20px;
    border-radius:12px;
    box-shadow:0 0 15px gold;
}
h2{
    text-align:center;
    color:gold;
}
input, textarea, button{
    width:100%;
    padding:12px;
    margin-top:10px;
    border-radius:8px;
    border:none;
    font-size:15px;
}
textarea{
    resize:vertical;
    min-height:120px;
}
button{
    background:gold;
    color:#000;
    font-weight:bold;
    cursor:pointer;
}
button:hover{background:orange}
.hidden{display:none}
.card{
    background:#111;
    padding:15px;
    border-radius:10px;
    margin-top:15px;
}
.small-btn{
    margin-top:6px;
    background:#333;
    color:white;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
    <h2>ğŸ” LOGIN</h2>
    <input type="password" id="password" placeholder="Ingiza password">
    <button onclick="login()">Ingia</button>
</div>

<!-- DASHBOARD -->
<div class="container hidden" id="dashboard">
    <h2>ğŸ“¡ MOSHARUTH WiFi</h2>

    <input id="jina" placeholder="Jina la mteja">
    <input id="kiasi" type="number" placeholder="Kiasi (Tsh)">
    <input id="namba" placeholder="Namba ya simu">
    <button onclick="saveData()">ğŸ’¾ Hifadhi</button>

    <button class="small-btn" onclick="backupData()">ğŸ“¥ Backup Data</button>
    <input type="file" id="restoreFile" onchange="restoreData(event)">

    <div id="list"></div>
</div>

<!-- MESSAGE EDIT -->
<div class="container hidden" id="msgBox">
    <h2>âœï¸ Hariri Ujumbe</h2>
    <textarea id="msgText"></textarea>
    <button onclick="sendWA()">ğŸ“² Tuma WhatsApp</button>
    <button onclick="sendSMS()" class="small-btn">ğŸ“© Tuma SMS</button>
    <button onclick="closeMsg()" class="small-btn">âŒ Funga</button>
</div>

<script>
// CONFIG
const LOGIN_PASSWORD = "goldnature44";
const WIFI_NAME = "RUGI";
const WIFI_PASSWORD = "goldnature44";

let currentIndex = null;

// LOGIN
function login(){
    if(password.value === LOGIN_PASSWORD){
        loginBox.classList.add("hidden");
        dashboard.classList.remove("hidden");
        loadData();
    }else{
        alert("âŒ Password sio sahihi");
    }
}

// SAVE DATA
function saveData(){
    if(!jina.value || !kiasi.value || !namba.value){
        alert("âš ï¸ Jaza taarifa zote");
        return;
    }
    let data = JSON.parse(localStorage.getItem("wifiData")) || [];
    data.push({jina:jina.value,kiasi:kiasi.value,namba:namba.value});
    localStorage.setItem("wifiData",JSON.stringify(data));
    jina.value="";kiasi.value="";namba.value="";
    loadData();
}

// LOAD
function loadData(){
    let data = JSON.parse(localStorage.getItem("wifiData")) || [];
    list.innerHTML="";
    data.forEach((d,i)=>{
        list.innerHTML+=`
        <div class="card">
            ğŸ‘¤ <b>${d.jina}</b><br>
            ğŸ’° Tsh ${Number(d.kiasi).toLocaleString()}<br>
            ğŸ“ ${d.namba}<br><br>
            <button onclick="editMsg(${i})">âœï¸ Ujumbe</button>
        </div>`;
    });
}

// MESSAGE TEMPLATE
function createMsg(d){
return `ğŸ‘‹ Habari ${d.jina} ğŸ˜Š

ğŸŒ *Karibu MOSHARUTH WiFi* âš¡
ğŸ“¶ Intaneti ya kasi â€¢ Imara â€¢ Uhakika

ğŸ“¡ WiFi: ${WIFI_NAME}
ğŸ” Password: ${WIFI_PASSWORD}

ğŸ’³ Malipo yamethibitishwa âœ…
ğŸ’° Kiasi: Tsh ${Number(d.kiasi).toLocaleString()}

ğŸš€ Furahia intaneti bila mipaka
ğŸ™ Asante kwa kutuchagua ğŸ’š`;
}

// EDIT MESSAGE
function editMsg(i){
    currentIndex=i;
    let d = JSON.parse(localStorage.getItem("wifiData"))[i];
    msgText.value = createMsg(d);
    msgBox.classList.remove("hidden");
}

// SEND WHATSAPP
function sendWA(){
    let d = JSON.parse(localStorage.getItem("wifiData"))[currentIndex];
    let num = d.namba.startsWith("0") ? "255"+d.namba.slice(1) : d.namba;
    window.open(`https://wa.me/${num}?text=${encodeURIComponent(msgText.value)}`,"_blank");
}

// SEND SMS
function sendSMS(){
    let d = JSON.parse(localStorage.getItem("wifiData"))[currentIndex];
    window.location.href = `sms:${d.namba}?body=${encodeURIComponent(msgText.value)}`;
}

// CLOSE MESSAGE
function closeMsg(){
    msgBox.classList.add("hidden");
}

// BACKUP
function backupData(){
    let data = localStorage.getItem("wifiData") || "[]";
    let blob = new Blob([data],{type:"application/json"});
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "wifi_backup.json";
    a.click();
}

// RESTORE
function restoreData(e){
    let file = e.target.files[0];
    let reader = new FileReader();
    reader.onload = ()=>{
        localStorage.setItem("wifiData",reader.result);
        loadData();
        alert("âœ… Data imerudishwa");
    };
    reader.readAsText(file);
}
</script>

</body>
</html>
